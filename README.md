# 运维

## linux常用的操作指令

### cd

- 切换目录

### ls

- 列表显示文件目录

### mv

- 移动，可以重命名

### pwd

- 显示当前位置

### cp

- 复制

### scp

- 远程上传、下载

### find

- 查找文件、目录

### du

- 统计目录以及文件的占用情况

### wc

- 统计个数

### which

- 查找命令

### grep

- 过滤文件内容

### head

- 查看文件大小

### tail

- 查看文件最后。默认10行

### cat

- 查看文件内容

### mkdir

- 创建目录

### touch

- 创建空文件

### rm

- 删除

### df

- 查看磁盘使用情况

### mount

- 挂载文件系统

## 网络服务

### dhcp

- 原理

	- 用于自动向连接到网络的设备分配IP地址和其他网络配置信息。DHCP服务器负责管理IP地址池和配置信息，并在设备连接时响应其请求

- 步骤

	- 安装dhcp服务器

		-  yum install dhcp

	- 建立主配置文件

		- /etc/dhcp/dhcpd.conf

	- 确定网段声明

		- Subnet 192.168.40.0 netmask 255.255.255.0{			//声明网段地址
	Range	192.168.4.128 192.168.4.254;			//设置地址池，可以又多个
	Option routers 192.168.4.1;					//指定默认网关地址
}


	- 启动服务

		- systemctl start dhcpd

### DNS

- 是维护一个地址数据库，其中记录了各种主机域名与 P 地址的对应关系，以便为客户程序提供正向或反向的地址查询服务，即正向解析与反向解析。

	- 正向解析-根据域名查ip

	- 反向解析-根据ip查域名

### samba

- Samba提供了smbd、nmbd两种服务器程序分别完成不同的功能

	- smbd：负责为客户机提供服务器中共享资源的访问

	- Nmbd：负责提供基于netbois协议的主机名称解析

- 原理

	- Samba是一种开源的跨平台网络文件共享服务

- 作用

	- 认证和访问控制

	- 文件共享

	- 打印机共享

### vsftp

- 原理

	- vsftpd工作在基于客户端-服务器模型的FTP协议之上，实现了可靠的文件传输

- 作用

	- 监听和连接

	- 身份验证

	- 访问控制

	- 文件传输

## 开机方式

### BIOS加电自检

- MBR扇区引导

	- grub引导

		- init初始化进程

			- 运行级别

				- 启动服务

## 数据库

### mysql

- 原理

	- MySQL是一种基于客户端-服务器架构的关系型数据库管理系统

- 优点

	- 多线程、多用户

	- 高性能

	- 高可靠

	- 易于使用

- 增删改查授权

- 备份恢复

	- 造成数据丢失的原因

		- 程序错误

		- 认为操作错误

		- 运算错误

		- 磁盘故障错误

		- 灾难（火灾、地震）和盗窃

	- 数据备份的分类

		- 物理备份

			- 冷备份

				- 脱机备份-关闭数据库进行

			- 热备份

				- 依赖数据库日志文件

			- 温备份

				- 数据库锁定表格，不可写入但可以读，进行备份

		- 逻辑备份

			- 完全备份

				- 每一次对数据库进行完整的备份

			- 差异备份

				- 备份从上次完全备份之后修改过的文件

			- 增量备份

				- 备份上次备份后修改过的文件

				- 基于位置-确定二进制文件的位置

				- 基于时间点-确定二进制文件的时间点

				- 一般恢复

- 读写分离

- 主从复制

### redis

## web服务服务

### http

- 定义

	- httpd是一个开源的Web服务器软件，被广泛用于Internet上的许多Web服务器。

- 作用

	- httpd可以接收和处理来自客户端的HTTP请求，将网页、图像、音频和其他内容发送给客户端，以提供Web服务。

- 优点

	- 高度稳定

	- 强大的功能

		- httpd提供了丰富的功能和灵活的配置选项，可以满足各种网站的需求。它支持多种HTTP协议版本、URL重写、虚拟主机、访问控制等众多功能

	- 高性能

		- httpd采用了多进程/多线程的工作方式，能够处理大量并发请求，实现高性能的HTTP服务。此外，它还支持动态模块加载，可以根据需要加载所需的模块，减少资源占用。

	- 可扩展性

		- httpd支持模块化扩展机制，允许用户根据需要自定义扩展模块，从而实现更多的功能和定制化需求。

	- 跨平台支持

		- httpd可在多个操作系统上运行，包括Unix/Linux、Windows等，具有很好的跨平台支持。

	- 社区支持

		- httpd是一个开源项目，拥有庞大的开发者社区和用户社群，提供丰富的文档、教程和支持资源，用户可以轻松获取帮助和解决问题。


	- 安全性

		- httpd具有多种安全功能，如SSL/TLS加密传输、访问控制、防止DDoS攻击等，能够保护Web服务器和数据的安全。

- 工作原理

	- httpd通过监听TCP端口来接收来自客户端的HTTP请求，处理请求并返回相应的响应。它使用基于多进程或多线程的模型来处理并发请求。

### nginx

- 定义

	- Nginx是一种高性能的开源Web服务器和反向代理服务器。它可以通过处理多个并发连接来提供快速的静态文件传输和动态内容的代理。Nginx的设计目标是保持高度的可伸缩性和效率，特别适用于大型的并发连接和高流量的网络应用。

- 作用

	- web服务器

		- 作为Web服务器，Nginx可以处理静态文件的传输

	- 反向代理服务器

		- 作为反向代理服务器，Nginx能够接收来自客户端的请求，并将其转发给多个后端服务器进行处理

- 优点

	- 轻量级

		- 它的代码精简且高效，仅占用很少的系统资源和内存

	- 高并发

		- Nginx的设计目标之一就是处理大量并发连接的能力。通过采用事件驱动的架构和异步非阻塞的IO操作，Nginx能够在较少的线程和进程数量下，同时保持高并发的连接

	- 安全性

		- 它可以用作反向代理，隐藏真实的后端服务器，并提供负载均衡和防止DDoS攻击的功能

	- 可靠性和稳定性

	- 高性能

		- Nginx采用了事件驱动的异步非阻塞架构，能够高效地处理并发连接和大量请求。它能够轻松地处理高流量和高并发的情况，提供快速的响应时间和高吞吐量。

- 工作原理

	- 接受分发请求

	- 解析处理请求

	- 静态文件处理

	- 动态内容代理

### tomcat

- 定义

	- Tomcat是一个开源的Java Servlet容器，用于在Java平台上运行Web应用程序

- 作用

	- Tomcat可以解析和执行Java Servlet、JavaServer Pages（JSP）和其他Java Web技术，提供对Java Web应用的支持。

- 优点

	- 轻量级

	- 易于配置和部署

	- 可扩展性强的特点

	- 适用于部署和运行Java Web应用程序

- 工作原理

	- Tomcat是Java Servlet容器，它创建TCP连接并监听Web端口，根据配置找到URL对应的Servlet，通过Java Servlet规范执行Servlet的逻辑，生成响应并发送回客户端。

### rsync远程同步

- 定义

	- 是一款开源的、快速的 多功能的 可以实现全量以及增量的本地或者是远程的数据同步（拷贝）备份的优秀工具

- 作用

	- 是linux系统下的数据镜像备份工具。使用快速增量备份工具Remote Sync可以远程同步，支持本地复制，或者与其他SSH、rsync主机同步。

### squid代理服务器

- 定义

	- Squid主要提供缓存加速、应用层过滤控制的功能。

- 类型

	- 传统代理

		- 适用于Internet，需在客户机指定代理服务器的地址和端口。

	- 透明代理

		- 客户机不需指定代理服务器的地址和端口，而是通过默认路由、防火墙策略将web访问重定向给代理服务器处理。

- 工作机制

	- 代替客户机向网站请求数热，从而可以隐藏用户的真实IP地址。

	- 将获得的网页数据（静态Web元素）保存到缓存中并发送给客户机，以便下次请求相同的数据时快速响应。

### pxe网络装机

- 原理

	- 一种通过网络远程安装操作系统的技术。它允许计算机在没有硬盘或其他存储设备的情况下，通过网络从服务器引导和安装操作系统

- 优点

	- 中心化管理

	- 减少硬件成本

	- 提高效率

	- 灵活性

- 步骤

	- PXE服务器

		- 存在操作文件和安装程序

	- dhcp服务器

		- 获取IP地址和PXE启动所需要的网络参数

	- tftp服务器

		- 将PXE的配置文件和操作系统传输给计算机

### ssh远程管理

- 原理

	- SSH(Secure Shell)是一种安全通道协议，主要用来实现字符界面的远程登录、远程、复制等功能，SSH协议对通信双方的数据传输进行了加密处理，其中包括用户登录时输入的用户口令，SSH为建立在应用层和传输层基础上的安全协议

- 免密登录

	- 生成公钥和密钥

	- 将公钥复制到远程服务器

	- 验证免密登录

## shell脚本

### 定义

- Shell 是一个应用程序，它连接了用户和 Linux 内核，让用户能够更加高效、安全、低成本地使用 Linux 内核，这就是 Shell 的本质

### 概念

- 1.将要执行的命令按顺序保存到一个文本文件

- 2.给该文件可执行权限

### 作用

- 负责接收用户输入的操作指令(命令并进行解释，将需要执行的操作传递给内核调动硬件执行，并输出执行结果。

### 应用场景

- 重复性操作

- 交互性任务

- 批量事务处理

- 服务运行状态监控

- 定时任务执行

## docker

## 程序安装

### 常见的封装类型

- rpm包

- deb包

- 源代码包

### yum

- 原理

	- 于RPM包管理，能够从指定的服务器自动下载RPM包并且安装，可以自动处理依赖性关系，并且一次安装所有依赖的软件包，无须繁琐地一次次下载、安装。yum提供了查找、安装、删除某一个、一组甚至全部软件包的命令。

- 安装方式

	- 本地安装	通过本地挂载镜像光盘安装

	- ftp安装		通过局域网的ftp服务安装

	- 网络安装	通过网络镜像进行安装

### rpm

### 程序目录结构

- 普通执行程序/usr/bin

- 服务器执行程序/usr/sbin

- 主配置文件/etc

- 日志文件/var/log

- 程序文档文件/usr/share/doc

## 账户管理

### 超级用户

- root

### 普通用户

- 拥有宿主目录的完整权限

	- 用户账户文件/etc/passwd

	- 用户密码文件/etc/shadow

	- 组账户文件/etc/group

### 程序用户

- 处理程序，保证程序正常运行，不允许登录系统

## 磁盘管理

### 静态磁盘管理

- fidks-查看管理磁盘

- mkfs-格式化分区，创建文件系统

- mkswap-创建交换分区

### LVM动态磁盘管理

- PV-物理卷

- VG-卷组

- LV-逻辑卷

- xfs_quota磁盘配额

	- 限制类型

		- 磁盘容量

		- 文件数量

	- 限制方法

		- 软限制-指定磁盘数值，超过提醒

		- 硬限制-指定硬性数据，超过拒绝写入

## 进程管理

### ps-静态查看系统进程

- user-启动用户账户名称

- pid-启动id号

- %cpu-查看cpu占用的百分比

- %mem-查看内存占用百分比

### top-动态查看系统进程

- H-按照内存占用情况进行排序

### kill-终止进程

### at-一次性任务设置

### crontab-周期性任务配置

### jobs-查看后台进程

- bg-后台进程恢复执行

- fg-后台进程恢复前台执行

## 故障排查

### MBR扇区故障

- 利用紧急修复工具重新构建MBR分区

### GRUB故障

- 进入急救模式重建grub菜单配置文件

## 网络配置

### ifconfig-查看网络配置

- /etc/sysconfig/network-scripts/

### hostname-查看主机名称

- /etc/hostname

### route-查看路由条目

### Tracerote-跟踪数据包的路由途径

### Nslookup-测试DNS域名解析

### DNS域名解析配置

- /etc/resolv.conf

- 本地映射文件：/etc/hosts

## 防火墙

### 含义

- 是指设置在不同网络与网络安全域之间的一系列部件的组合，也是不同安全域之间信息的唯一出口，通过监测，限制并更改跨越防火墙的数据流，尽可能地对外屏蔽网络内部的信息、结构和运行状态，且有选择地接受外部网络访问。在内外网之间架起一道屏障，以避免发生不可预知或潜在的入侵

### 控制端口

### 控制服务

### 端口转发

### 地址伪装

## 群集

### 概念

- 根据不同的企业有着不同的群集，采用的技术各有千秋，整体来看有着共性特征。群集技术是利用多台计算机合作完成一项任务的技术。这些计算机在逻辑上是一个整体，共同承担着任务的执行和负载的分配。它们通过高速网络进行通信，集中控制和管理资源，协同完成任务。

### 分类

- 负载均衡群集

	- 提高相应速率，尽可能完成多的访问请求，实现高并发

- 高可用群集

	- 提高系统可靠性

	- 双主模式

		- 主机挂了，从机顶替主机进行工作

	- 主从模式

		- 两台服务器同时进行工作

### nginx+tomcat负载均衡群集

- nginx作为前端服务器，接受客户端请求，并且将请求分发到后端的tomcat服务器，采用不通的负载均衡策略（轮询、最小连接）确保请求均匀的分发给tomcat服务器

- Tomcat是一个Java应用程序容器，用于运行Java Web应用程序。它负责解析和执行服务器端的Java代码，并将结果返回给Nginx服务器。

### LVS负载均衡群集

- 分层结构

	- 负载调度器

		- 这是访问整个群集的唯一入口对外使用所有服务器共有的VIP（虚拟IP）地址，也称为群集IP地址通常使用主、备俩台调度器确保群集的高可用。

	- 服务器池

		- 每一台都有自己的地址，通过负载调度分发给每一个服务器池

	- 共享存储服务

		- 为服务器池提供一致的文件存储服务，保证群集的统一性

- 工作模式

	- NAT模式

		- 负载调度器作为所有服务器节点的网关，即作为客户机的访问入口，也是各节点回应客户机的访问出口

	- IP隧道模式

		- 负载调度器仅作为客户机的访问入口，各节点通过各自的 nternet 连接直接回应客户机，而不再经过负载调度器

		- 务器节点分散在互联网中的不同位置，具有独立的公网 IP 地址

	- 直连路由

		- 负载调度器与各节点服务器通过本地网络连接，不需要建立专用的 IP 隧道。

		- 负载调度器仅作为客户机的访问入口，各节点通过各自的 nternet 连接直接回应客户机

- 管理工具

	- ipvsadm

### keepalived双机热备

- 通过使用VRRP协议和心跳检测，Keepalived实现了高可用性和故障自动转移。它允许多个服务器共享一个虚拟IP地址，确保即使其中一个主机出现故障，服务仍然可用。此外，结合负载均衡功能，Keepalived还可以实现流量的分发和负载均衡
- 

